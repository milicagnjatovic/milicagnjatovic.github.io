<!DOCTYPE html>

<html>
<head>
    <title>Milica Gnjatović</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="public/css/index.css">  
    <link rel="stylesheet" type="text/css" href="public/css/casovi.css">  
    <script type="text/javascript" src="public/js/index.js"></script>
    <script type="text/javascript" src="public/js/gen_cas.js"></script>
</head>

<body>


    <div id = "header">
        <h2>Milica Gnjatović</h2>

            <table id="menu">
                <tr>
                    <th> <a href="./index.html"> časovi </a> </th>                    
                    <th> <a href="./about_me.html"> o meni </a> </th>
                </tr>
            </table>

    </div>

    <a href="#left_menu" id="pocetak">POČETAK</a>

    <main>
        <div id="left_menu">
            <table>
                <tr><td><a href="#podesavanje_sistema">Podešavanje sistema</a></td></tr>
                <tr><td><a href="#cas1">ČAS 1</a></td></tr>
                <tr><td><a href="#cas2">ČAS 2</a></td></tr>
                <tr><td><a href="#cas3">ČAS 3</a></td></tr>
                <tr><td><a href="#cas4">ČAS 4</a></td></tr>
                <tr><td><a href="#cas5">ČAS 5</a></td></tr>
                <tr><td><a href="#cas6">ČAS 6</a></td></tr>
                <tr><td><a href="#cas7">ČAS 7</a></td></tr>
                <tr><td><a href="#cas8">ČAS 8</a></td></tr>
                <tr><td><a href="#cas9">ČAS 9</a></td></tr>
                <tr><td><a href="#recap">SQL RECAP</a></td></tr>
                <tr><td><a href="#cas10">ČAS 10</a></td></tr>
                <tr><td><a href="#cas11">ČAS 11</a></td></tr>
            </table>
        </div>

        <div id="right_menu">
            <p> Kontakt: milica_gnjatovic[at]matf.bg.ac.rs</p>
            
            <h3><a href="http://www.bazepodataka.matf.bg.ac.rs/RelacioneBazePodataka.html#0_tab">Zvanična stranica predmeta</a></h3>

            <h3>Snimak nadoknade</h3>
            <a href="https://matf.webex.com/matf/ldr.php?RCID=1dacaf5a68580844cb3d203555433195">Snimak</a> <br>
            Šifra: RBP5petak
            
            <p>Ukoliko nekog zanima funkcionalno programiranje može da isprati naredni <a href="https://forum.hklbgd.org/t/radionica-funkcionalnog-programiranja/258" target="_blank">link</a>.</p>

            <h3>Prisustvo</h3>
            <p>Prisustvo se NE BODUJE. Zamolila bih studente da unesu na kojim časovima su bili.
                Ovo će biti kao malo istraživanje da li studenti koji dolaze na vežbe postižu bolje razultat od onih koji ne dolaze.
                <a href="https://docs.google.com/spreadsheets/d/1vs1RbOP7habpQxw_e56Qwbuf2BysVfEH2rMzpADlM08/edit?usp=sharing">tabela</a>
            </p>
            
            <h1 id="podesavanje_sistema">Podešavanje sistema</h1>
            <p>
                Softver potreban za vežbe:
                <ul>
                    <li> IBM DB2 sistem za upravljanje bazama podataka </li>
                    <li> IBM Data Studio alat za rad sa bazama podataka</li>
                    <li> Studentska baza podataka <i>stud2020</i></li>
                </ul>

                Ili preuzeti virtuelnu mašinu. <a href="http://enastava.matf.bg.ac.rs/~mirjana/BazePodataka2020_nova.zip"> VM </a>

                <h3> Ukoliko preuzimate virtuelnu mašinu</h3>
                <p> Ako koristite stariju verziju VMware plejera i dobijate grešku pri pokretanju VM, potrebno je da otvorite .vmx datoteku i promenite vrednost za virtualHW.version na Vašu verziju plejera, npr. ako je 15 postavite
                    <br>
                    virtualHW.version = "15". 
                    <ul>
                        <li>korisnik: <b>student</b></li>
                        <li>šifra: <b>abcdef</b></li>
                    </ul>
                </p>

                <h3>Ukoliko želite sami da preuzmete programe</h3>
                <p>Potrebno je napraviti nalog na IBM-u sa studentskim mejlom. <br>
                <ul>
                    <li>
                        <a href="resources/rbp/db2_installation_instruction.pdf" target="_blank"> uputstvo za instairanje DB2 </a> <br>
                        <a href="resources/rbp/db2_installation_instruction2.pdf">dodatno uputsvo</a><br>
                        <a href="https://epwt-www.mybluemix.net/software/support/trial/cst/programwebsite.wss?siteId=1120&tableid=2932&p=null&h=null">Link za preuzimanje DB2</a>, nalog se pravi sa alas mejlom, ukoliko traži multifaktorsku autentifikaciju najlakše je da stavite još jedan mejl.
                    </li>
                    <li><a href="resources/rbp/data_studio_installation_instruction.pdf" target="_blank"> uputstvo za instairanje data studija </a></li>
                    <li><a href="http://www.matf.bg.ac.rs/~mirjana/stud2020.zip" target="_blank"> skripta za uvoženje baze </a>
                        <br>
                        Uputstvo: unzipovati folder i pozicionirati se u njega. U terminalu pokrenuti <i>./create.sh</i>. <br>
                        Napomena: može biti potrebno promeniti mod fajla komandom:
                        <p class="kod">chmod +x create.sh</p> Ovu liniju je potrebno izvršiti u baznom folderu i dva podfoldera. Može da potraje par minuta.
                    </li>
                </ul>
                </p>

                <h3> Struktura baze podataka </h3>
                <ul>
                    <li><b>DA</b> - podaci zapisani ASCII kodnom shemom</li>
                    <li><b>DB</b> - podaci zapisani UTF-8 kodnom shemom</li>
                </ul>

                <img src="resources/rbp/dijagram_stud2020.png" alt="stud2020" style="width: 100%;">

                <h1 id="cas1">ČAS 1</h1>

                <h3>Komande u db2:</h3>
                <div class="kod">
                    <table class="basic_underline">
                        <tr>
                            <td>db2start</td>
                            <td>pokretanje</td>
                        </tr>
                        <tr>
                            <td>db2stop</td>
                            <td>zaustavljanje</td>
                        </tr>
                        <tr>
                            <td>db2 list db directory </td>
                            <td>lista svih baza u sistemu</td>
                        </tr>
                        <tr>
                            <td>db2</td>
                            <td>pokretanje interkativnog okruženja</td>
                        </tr>
                        <tr>
                            <td>db2 connect to IME_BAZE</td>
                            <td>povezivanje na bazu podataka</td>
                        </tr>
                        <tr>
                            <td>db2 connect to IME_BAZE user IME_KORISNIKA using SIFRA</td>
                            <td>povezivanje na bazu podataka kao određeni korisnik</td>
                        </tr>
                        <tr>
                            <td>db2 connect reset</td>
                            <td>diskonektovanje</td>
                        </tr>
                        <tr>
                            <td>db2 list tables</td>
                            <td>prikaz tabela u bazi za podrazumevanu shemu</td>
                        </tr>
                        <tr>
                            <td>db2 values current schema</td>
                            <td>prikaz trenutne sheme</td>
                        </tr>
                        <tr>
                            <td>db2 list tables for schema IME_SHEME</td>
                            <td>prikaz tabela u bazi za određenu shemu</td>
                        </tr>
                        <tr>
                            <td>db2 describe table IME_TABELE/IME_SHEME.IME_TABELE </td>
                            <td>informacije o tabeli</td>
                        </tr>
                        <tr>
                            <td>db2 "UPIT" </td>
                            <td>dohvatanje podataka iz baze</td>
                        </tr>
                        <tr>
                            <td>db2 -f PUTANJA_DO_FAJLA -v </td>
                            <td>izvršavanje upita iz fajla, -v naglašava da se svaki upit završava sa <b>;</b>. Može se dodati -v da se prikaže upit koji je izvršen. U jednom fajlu može biti više upita.</td>
                        </tr>
                    </table>
                </div>

                <p><b>Baza podataka</b> - kolekcija podataka organizovana na određen način; različiti tipovi, objektne, nerelacione, relacione...</p>
                <p><b>Sistem za upravljanje bazom podataka (SUBP) </b>- program koji omogućava pristup i rad sa podacima iz baze, to je ibm db2.</p>
                <p><b>Relacione baze podataka (RBP)</b> - podaci se predstavljaju u okviru relacija/tabela</p>
                <p><b>Entitet</b> - neki objekat, prikazuje se tabelom; student, predmet, ispit...</p>
                <p><b>Atribut</b> - opisuje objekat, kolone tabele; indeks, ime, prezime...</p>
                <p><b>Student</b> (<u>indeks</u>, ime, prezime, datum_rođenja, mesto_rođenja)</p>
                <p><b>Red/ntorka</b> - podaci o jednom entitetu/studentu/ispitu...</p>
                <p><b>Relaciona baza</b> - skup relacija/tabela</p>
                <p><b>Relaciona shema</b> - opis strukture relacija</p>
                <p><b>SQL</b> - sredstvo za upravljanje relacionom bazom podatka, upitni jezik</p>
                <p><b>Primarni ključ</b> - atribut ili skup atributa koji jedinstveno opisuju entitet</p>
                <p><b>Strani ključ</b> - atribut ili skup atributa kojim se pravi veza ka drugoj relaciji</p>
                <p><b>Shema</b> - grupisane tabele u pogled koji čini celinu, npr. shema za profesore i shema za studente</p>

                <p>
                    <h3>Redosled izvršavanja:</h3>
                    3 SELECT <i>- kolone koje će se prikazati, * da se prikažu sve kolone </i> <br> 
                    1 FROM <i>- odakle izvlačimo podatke, koja tabela </i> <br>
                    2 WHERE <i>- uslovi koje rezultati treba da ispunjavaju</i><br>
                </p>

                <h3>Rad u Data studiju</h3>
                Pre početka je potrebno pokrenuti db2 iz terminala komandom <p class="kod">db2start</p>
                <img src="resources/rbp/data_studio1.png" alt="data studio" style="width:100%;">
                <ol>
                    <li>Open perspective > Data </li>
                    <li>Desni klik > connect > uneti korisničko ime i šifru > test connection (treba da je okej) > connect  
                        <br>
                        Ukoliko nema ponuđeno stud2020: desni klik na Database Connections > new > DB2 for Linux, Unix and Windows > host: stud2020, username an password, identično prethodom koraku. 
                    </li>
                    <li> Pravljenje novog sql skripta</li>
                    <li> Click here to connect to database > izabrati stud2020 > finish </li>
                    <li> Dugme za izvršavanje unetog upita.</li>
                    <li> Ovde se nalazi rezultat upita ili eventualna poruka o grešci.</li>
                </ol>

                <img src="resources/rbp/data_studio2.png" alt="data studio" style="width:100%;">
                <ol>
                    <li> Desni klik na DA > Add to Overview Diagram > mogu se izabrati željene tabele, dovoljno je ok </li>
                    <li> Čekirati da bi se prikazale kolone u tabeli. Ako se ne vidi ovakav prikaz klikuti na polju pored neke od tabela (da nije tabela selektovana).</li>
                    <li> Ovde se mogu videti dodatne informacije o tabelama, npr koje kolone ima i kog su tipa.</li>
                </ol>

                <div id="cas1zadaci"></div>
                <script>
                    loadClassFromJSON("cas1zadaci", "resources/rbp/cas1.json")
                </script>


<!-- CAS2-->
            <h1 id="cas2">ČAS 2</h1>
            <h3>Vrste spajanja</h3>

            <img src="resources/rbp/spajanje.png" width="100" style="width: 100%;">

        <div id="cas2zadaci"></div>
        <script>
            loadClassFromJSON("cas2zadaci", "resources/rbp/cas2.json")
        </script>
<!-- CAS2 KRAJ-->

<!-- CAS3-->
        <h1 id="cas3">ČAS 3</h1>
        <h3>Podupiti</h3>
        <dl>
            <dt>X [NOT] IN (SELECT Y FROM ... WHERE ...)</dt>
            <dd> Gledamo da li je X u nizu Y-ona koji dobijamo iz podupita. Važno je da X i Y imaju isti broj atributa. Na primer možemo imati WHERE (OZNAKAROKA, SKGODINA) IN (SELECT OZNAKA, GODINA FROM ...).  </dd>
            
            <dt>[NOT] EXISTS (SELECT ... FROM ...)</dt>
            <dd>Uslov je zadovoljen ako podupit vraća bar jedan red.</dd>

            <dt>X < ALL (SELECT ... FROM ...)</dt>
            <dd>Uslov je zadovoljen ako je X manje od svake vrednosti koju vraća podupit. Mogu se koristi i ostali operatori.</dd>

            <dt>X < SOME (SELECT ... FROM ...)</dt>
            <dd>Uslov je zadovoljen ako je X manje od neke vrednosti koju vraća podupit. Mogu se koristi i ostali operatori.</dd>

            <dt>X = ANY (SELECT ... FROM ...)</dt>
            <dd>Uslov je zadovoljen ako je X jednako nekoj vrednosti koju vraća podupit. Mogu se koristi i ostali operatori.</dd>

        </dl>

        <p>
        <b>SVAKI <=> NE POSTOJI NEKI KOJI NIJE</b>
        <br>
        Tražimo studenta koji je položio svaki ispit koji je polagao. <=> Tražimo studenta za kog NE POSTOJI ispit koji NIJE POLOŽIO.
        </p>

        <div id="cas3zadaci"></div>
        <script>
        loadClassFromJSON("cas3zadaci", "resources/rbp/cas3.json")
        </script>

        <h4>Napomene posle časa:</h4>
        <ul>
            <li>Drugom zadatku je dodata napomena uz još jedno rešenje.</li>
            <li>
                <p>U narednom primeru ćemo imati grešku jer se u order by ne zna da li želimo da uredimo po indeksu iz tabele dosije ili po indeksu iz tabele ispit. Možemo to rešiti tako što ćemo staviti order by D.INDEKS ili order by I.INDEKS.</p>
                <p class="kod">
                    SELECT *<br>FROM DA.ISPIT I JOIN DA.DOSIJE D<br><tab></tab>ON I.INDEKS = D.INDEKS<br>ORDER BY INDEKS;
                </p>
                <p>Međutim, u narednom primeru nemamo grešku jer se u select nalazi jedan indeks, pa se po njemu uređuje.</p>
                <p class="kod">SELECT D.INDEKS, IME<br>FROM DA.ISPIT I JOIN DA.DOSIJE D<br><tab></tab>ON I.INDEKS = D.INDEKS<br>ORDER BY INDEKS;</p>
            </li>
        </ul>
<!-- CAS3 KRAJ-->

<!-- CAS4 -->
<h1 id="cas4">ČAS 4</h1>
<h3>Skupovni operatori</h3>
<dl>
    <dt>UNION</dt>
    <dd>
        <i>upit1</i> UNION <i>upit2</i> nam daje sve redove iz upita1 i upita2 bez duplikata. Važno je da i prvi i drugi upit vraćaju isti broj kolona i da su te kolone istog tipa. Na primer u redu je ako prvi upit vraća ime (string), ocenu (broj), a drugi prezime (string), indkeks (broj). Nije u redu ako prvi vraca ocenu (broj), a drugi ime (string).
    </dd>

    <dt>UNION ALL</dt>
    <dd>Identično kao UNION samo što ovde možemo imati duplikate. Efikasnije je od UNION jer ne proverava duplikate. UNION je kao da smo na UNION ALL primenili DISITNCT.</dd>

    <dt>INTERSECT</dt>
    <dd>
        <i>upit1</i> INTERSECT <i>upit2</i> nam daje sve redove iz upita 1 koji postoje i u upitu 2 bez duplikata. Važno je da i prvi i drugi upit vraćaju isti broj kolona i da su te kolone istog tipa.
    </dd>

    <dt>INTERSECT ALL</dt>
    <dd>Identično kao INTERSECT samo što ovde možemo imati duplikate. Efikasnije je od INTERSECT jer ne proverava duplikate. INTERSECT je kao da smo na INTERSECT ALL primenili DISITNCT.</dd>

    <dt>EXCEPT / MINUS</dt>
    <dd> <i>upit1</i> EXCEPT <i>upit2</i> nam daje sve redove iz upita 1 koji ne postoje u upitu 2 bez duplikata. Važno je da i prvi i drugi upit vraćaju isti broj kolona i da su te kolone istog tipa. EXCEPT i MINUS su sinonimi i potpuno je svejedno da li koristimo jedno ili drugo.
    </dd>

    <dt>EXCEPT ALL</dt>
    <dd> <i>upit1</i> EXCEPT ALL <i>upit2</i> nam daje sve redove iz upita 1 koji ne postoje u upitu 2 uzimajući u obzir duplikate. Ako prvi upit vraća X za svaku ocenu 10, a drugi upit vraća X za svaku ocenu 6, i ako student ima 5 desetki i 3 šestice u rezultatu će biti 2 reda sa X. Ako bi u ovom primeru koristili samo EXCEPT dobili bi praznu tabelu kao rezultat.</dd>
</dl>

<h3>Funkcije za rad sa datumom i vremenom</h3>
<dl>
    <dt>CURRENT TIME, CURRENT DATE</dt>
    <dd>specijalni registri koji sadrže vrednost trenutnog vremena, odnosno datuma</dd>

    <dt>DATE(expression)</dt>
    <dd>expression može biti string u formatu "dd.mm.yyyy"</dd>
    
    <dt>YEAR(date)</dt>
    
    <dt>MONTH(date)</dt>
    <dd>redni broj meseca u godini</dd>
    
    <dt>WEEK(date)</dt>
    <dd>redni broj nedelje u godini</dd>
    
    <dt>DAY(date) / DAYOFMONTH(date)</dt>
    <dd>redni broj dana u mesecu</dd>

    <dt>DAYOFYEAR(date)</dt>
    <dd>redni broj dana u godini</dd>

    <dt>DAYOFWEEK(date)</dt>
    <dd>redni broj dana u nedelji, 1 je subota, dok je 7 nedelja</dd>

    <dt>DAYNAME(date)</dt>
    <dd>naziv dana u nedelji; ukoliko želimo da zadamo jezik možemo ga dodati kao drugi argument, za srpski bi kod bio 'sr_latn_sr' ili 'sr_cirilc_sr'</dd>

    <dt>MONTHNAME(date)</dt>
    <dd>naziv meseca; ukoliko želimo da zadamo jezik možemo ga dodati kao drugi argument, za srpski bi kod bio 'sr_latn_sr' ili 'sr_cirilc_sr'</dd>

    <dt>DAYS(date)</dt>
    <dd>brojevna reprezentacija datuma</dd>
    
    <dt>TIME(expression)</dt>
    <dd>vraća vreme, expression može biti u formatu hh:mm</dd>

    <dt>TIMESTAMP(date, time)</dt>
    <dd>vraća format koji sadrži datum i vreme</dd>

    <dt>HOUR(time), MINUTE(time), SECOND(time)</dt>
    <dd>vraća broj sati, minuta i sekundi za vreme</dd>

    <dt>YEARS_BETWEEN(date1, date2), MONTHS_BETWEEN(date1, date2), DAYS_BETWEEN(date1, date2)</dt>
    <dd>Koliko je godina, meseci, dana prošlo između dva datuma. Ako gledamo mesece na primer a prošlo je 2 godine i 3 meseca reulatat će biti 27 meseci, a ne 3.</dd>

    <dt>SECOND[S], MINUTE[S], HOUR[S], DAY[S], MONTH[S], YEAR[S]</dt>
    <dd>
        ključne reči koje nam omogućuju da dodajemo na neki datum ili na neko vreme <br>
        Na primer: 
            <ul>
                <li>CURRENT TIME + 5 MINUTES - 5 SECONDS</li>
                <li>DATE('1.1.2020') + 5 YEARS (u ovom slučaju nije dovoljno samo niska za datum, već je potrebno i DATE da se naglasi da je datum jer db2 ne može sam da zaključi)</li>
            </ul>
    </dd>
</dl>

<h3>Funkcije za rad sa karakterima</h3>
<dl>
    <dt>SUBSTR(str, start, len)</dt>
    <dd>Vraća podnisku niske str, koja počinje od start a dužine je len. Indeksiranje kreće od 1. Ukoliko se ne navede len izdvaja se podniska od pozicije start do kraja niske. </dd>

    <dt>CONCAT(x, y), x || y</dt>
    <dd>Spaja niske x i y. CONCAT prima tačno dva argumenta, dok ako koristimo operator || možemo ulančati više stringova (a || b || c ...).</dd>

    <dt>SPACE(x)</dt>
    <dd>Vraća x praznih mesta.</dd>

    <dt>POSSTR(x, y)</dt>
    <dd>Vraća indeks na kom počinje niska y u niski x. Ukoliko se y ne nalazi u x vraća 0.</dd>

    <dt>REPEAT(str, x)</dt>
    <dd>Ponavlja nisku str x puta.</dd>

    <dt>REPLACE(str, x, y)</dt>
    <dd>Zamenjuje sva pojavljivanja niske x u str sa y.</dd>

    <dt>LTRIM(str), TRIM(str), RTRIM(str)</dt>
    <dd>Uklanja beline levo, desno ili sa obe strane.</dd>

    <dt>LENGTH(arg)</dt>
    <dd>Vraća dužinu argumenta, koji može biti string ili broj.</dd>
</dl>

<h3>Funkcije za nedefinisane vrednosti</h3>
<dl>
    <dt>COALESCE(x, y, z...)</dt>
    <dd>Vraća prvi argument iz liste čija vrednost nije NULL. Ako su svi agumenti NULL onda se NULL i vraća.</dd>

    <dt>NULLIF(x, y)</dt>
    <dd>Vraća NULL ako su x i y jednaki. Ukoliko su argumenti različiti onda vraća prvi argumenti.</dd>
</dl>

<h3>Funkcije za konverziju</h3>
<dl>
    <dt>DECIMAL(x, y, z), DEC(x, y, z)</dt>
    <dd>Vraća decimalnu reprezentaciju x, pri čemu y predstavlja ukupan broj cifara, a z broj mesta iza decimalnog zareza. X može biti broj ili string.</dd>

    <dt>DOUBLE(x)</dt>
    <dd>Vraća broj veće preciznosti. X može biti string ili broj.</dd>

    <dt>DECIMAL(expression)</dt>
    <dd>Vraća string reprezentaciju broja.</dd>

    <dt>CHAR(expression)</dt>
    <dd>Skoro sve tipove pretvara u string.</dd>

    <dt>CHAR(datetime, format)</dt>
    <dd>Datum i vreme prikazuje u datom formatu. Dostupni formati su ISO, USA, EUR, JIS, LOCAL.</dd>
</dl>

<h3>Numeričke funkcije</h3>
<dl>
    <dt>MOD(x, y)</dt>
    <dt>ABS(x)</dt>
    <dt>SIGN(x)</dt>
    <dd>Vraća 1 za pozitivne, -1 za negativne, 0 za 0.</dd>
    <dt>SQRT(x)</dt>
    <dd>Vraća koren broja.</dd>
    <dt>RAND(seed)</dt>
    <dd>Vraća random broj. Seed argument nije obavezan, za isti seed se dobija isti 'random' broj.</dd>
    <dt>CEIL, FLOOR</dt>
    <dd>Zaokružuje broj na veći, odnosno manji.</dd>
    <dt>SIN, COS, TAN, COTAN, ASIN, ACOS, ATAN, EXP...</dt>
    <dt>ROUND(num, broj_decimala)</dt>
</dl>

<p>Na narednom linku možete naći još sklarnih funkcija i informacije o njima: <a href="https://www.ibm.com/docs/en/db2/11.5?topic=functions-scalar">dokumentacija</a>.</p>
<div id="cas4zadaci"></div>
    <script>
    loadClassFromJSON("cas4zadaci", "resources/rbp/cas4.json")
    </script>
<!-- CAS4 KRAJ-->

<!-- CAS5-->

    <h1 id="cas5">ČAS 5</h1>

    <img src="/resources/rbp/groupby.png" alt="group by" style="width:100%;">

    <div id="cas5zadaci"></div>
    <script>
    loadClassFromJSON("cas5zadaci", "resources/rbp/cas5.json")
    </script>
<!-- CAS5 KRAJ-->

<!-- CAS6-->

<h1 id="cas6">ČAS 6</h1>
<h3>WITH klauza</h3>
<p>With klauzom možemo definisati privremenu tabelu koju koristimo u upitu.</p>
<p class="kod">
    <b>WITH</b> POMOCNA_TABELA <b>AS</b> (<br>
        <tab></tab> SELECT ... FROM ... <br>
    )<br>
    SELECT ... <br> 
    FROM POMOCNA_TABELA <br>
    ...
</p>

<p class="kod">
    <b>WITH</b> POMOCNA_TABELA(kolona1, kolona2 ...) <b>AS</b> (<br>
        <tab></tab> SELECT ... FROM ... <br>
    )<br>
    SELECT ... <br> 
    FROM POMOCNA_TABELA <br>
    ...
</p>

<p>Pomoćnu tabelu možemo koristiti kao i bilo koju drugu tabelu iz baze, možemo je spajati sa drugim tabelama, grupisati... <br>
    Možemo definisati više pomoćnih tabela:
    
    <p class="kod">
        <b>WITH</b> POMOCNA_TABELA <b>AS</b> (...), <br>
        <tab></tab> DRUGA_POMOCNA_TABELA <b>AS</b> (...), <br>
        <tab></tab> ... <br>
        SELECT ... <br> 
        FROM ... <br>
        WHERE ...
    </p>

    Važno je da pri definisanju pomoćne tabele svakoj koloni damo ime.</p>
<div id="cas6zadaci"></div>
<script>
loadClassFromJSON("cas6zadaci", "resources/rbp/cas6.json")
</script>
<!-- CAS6 KRAJ-->


<!-- CAS7-->

<h1 id="cas7">ČAS 7</h1>
<h2>Kreiranje tabela</h2>
<p class="kod">
    <b>CREATE TABLE</b> NAZIV_TABELE (<br>
    <tab></tab>NAZIV_KOLONE1 TIP_KOLONE1 <br>
    <tab></tab>NAZIV_KOLONE2 TIP_KOLONE2 <b>NOT NULL</b> <br>
    <tab></tab>NAZIV_KOLONE3 TIP_KOLONE2 <b>DEFAULT ... </b> <br>
    <tab></tab>...<br>
    <tab></tab>NAZIV_KOLONEN TIP_KOLONEN <br>
    <tab></tab><b>PRIMARY KEY</b> (KOLONA_KLJUC1, KOLONA_KLJUC2...) <br>
    <tab></tab><b>FOREIGN KEY</b> FK_NAZIV_KLJUCA (NAZIV_KOLONE_OVE_TABELE) <b>REFERENCES</b> NAZIV_TABELE_KOJU_REFERISE <br>
    <tab></tab><b>CONSTRAINT</b> NAZIV_OGGRANICENJA <b>CHECK</b> ( ... )<br>
    ) 
</p>

<p>
    Primarni ključ može činiti više kolona. Važno je da svaka kolona bude definisana sa NOT NULL. Primarni ključ se još može definisati tako što u nazivu kolone dodamo primary key, npr ID INTEGER NOT NULL PRIMARY KEY.<br>
    Umesto komande CREATE TABLE ... , možemo korisiti CREATE TABLE <b>IF NOT EXISTS</b> ... kojom kreiramo tabelu samo ukoliko ona već ne postoji. <br>
    
    Ukoliko ne želimo ručno da unosimo vrednost primarnog ključa ona može automatski da se generiše:
    <ul>
        <li>
            <p class="kod">NAZIV_KOLONE INTEGER NOT NULL <b>GENERATED ALWAYS AS IDENTITY</b> (MINVALUE 1)</p>
            <p>U ovom slučaju vrednost ne možemo da unosimo ručno već se uvek automatski dodaje. Minval je opciono.</p>
        </li>

        <li>
            <p class="kod">NAZIV_KOLONE INTEGER NOT NULL <b>GENERATED BY DEFAULT AS IDENTITY</b> </p>   
            <p>Vrednost se dodaje automatski ukoliko nije navedena.</p>
        </li>
    </ul>
    <p>Više o ovome se može naći u <a href="https://www.ibm.com/docs/en/db2-warehouse?topic=concepts-auto-numbering-identifier-columns">dokumentaciji</a>.</p>
</p>
Neki od dozvoljenih tipova za kolone su:
<ul>
    <li>SMALLINT, INTEGER/INT, BIGINT, DECIMAL/DEC, FLOAT(BROJ DECIMALA), REAL, DOBULE</li>
    <li>CHARACTER/CHAR</li>
    <li>CHARACTER/CHAR[max broj karaktera u niski]</li>
    <li>VARCHAR[max broj karaktera u niski]</li>
    <li>DATE, TIME, TIMESTAMP</li>
    <li>BOOLEAN</li>
</ul>

<p>Lista tabela u bazi se može videti sa nekom od narednih komandi iz terminala:</p>
<ul>
    <li class="kod">db2 lista tables</li>
    <li class="kod">db2 lista tables for naziv_sheme</li>
</ul>
<p>Treba obratiti pažnju gde je kreirana baza, tj. da li u nekoj shemi.</p>

<h2>Kopiranje tabele </h2>
<p class="kod">
    <b>CREATE TABLE</b> NAZIV_KOPIJE_SA_PODACIMA <b>AS</b> (<br>
	<tab></tab>SELECT *<br>
	<tab></tab>FROM ORIGINALNA_TABELA<br>
) <b>WITH DATA</b>;
</p>
<p class="kod">
    <b>CREATE TABLE</b> NAZIV_KOPIJE_BEZ_PODATAKA <b>AS</b> (<br>
	<tab></tab>SELECT *<br>
	<tab></tab>FROM ORIGINALNA_TABELA<br>
) <b>WITH NO DATA</b>;

<p>Ovo je korisno ako želite da vežbate izmenu i brisanje redova, a da pri tom ne menjate originalnu tabelu.</p>

<h2>Promena strukture tabele</h2>
<p class="kod"> <b>ALTER TABLE</b> NAZIV_TABELE ... </p>
Moguće su naredne izmene:
<ul>
    <li class="kod"> DROP NAZIV_KOLONE </li>
    <li><p class="kod"> ADD NAZIV_KOLONE TIP_KOLONE</p>
        Ukoliko ne navedemo DEFAULT NEKA_VREDNOST, vrednosti koje su već bile u bazi će za vrednost u toj koloni imati NULL.
        Ukoliko želimo da ta kolona koju dodajemo bude NOT NULL moramo obavezno navesti podrazumevanu vrednost.
    </li>
    <li class="kod"> ADD CONSTRAINT NAZIV_OGRANICENJA CHECK (...) </li>
    <li class="kod"> DROP CONSTRAINT NAZIV_OGRANICENJA </li>
    <li class="kod"> ALTER COLUMN NAZIV_KOLONE SET DEFAULT .... </li>
</ul>

Nakon promene strukture tabele u nekim slučajevima je neophodno reorganizovati tabelu komandom iz terminala:
<p class="kod">
    db2 connect to naziv_baze <br>
    db2 reorg table naziv_tabele
</p>

<h2>Brisanje tabele iz baze</h2>
<p class="kod"><b>DROP TABLE</b> NAZIV_TABELE;</p>
<p class="kod"><b>DROP TABLE IF EXISTS</b> NAZIV_TABELE;</p>
Ukoliko pokušamo da obrišemo tabelu koja ne postoji prva verzija će izbaciti grešku, dok druga neće.

<h2>Dodavanje redova u bazu</h2>
<p class="kod">
    <b>INSERT INTO </b> NAZIV_TABELE(KOL1, KOL2, ... , KOLN) <b>VALUES</b> <br>
    <tab></tab> (VREDNOST_KOL1, VREDNOST_KOL2, ... , VREDNOST_KOLN), <br>
    <tab></tab> (VREDNOST_KOL1, VREDNOST_KOL2, ... , VREDNOST_KOLN), <br>
    <tab></tab>...
</p>
<p class="kod">
    <b>INSERT INTO </b> NAZIV_TABELE(KOL1, KOL2, ... , KOLN)<br>
    SELECT ... <br>
    FROM ...
</p>
<p>Ukoliko se ubacuje vrednost za svaku kolonu redom onda nije neophodno navoditi nazive kolona. Vrednosti koje se ne unesu će biti NULL.</p>

<h2>Izmena podataka u bazi</h2>
<p class="kod">
    <b>UPDATE</b> NAZIV_TABELE <br>
    <b>SET</b> KOL1 = VREDNOST,<br>
    <tab></tab>KOL2 = CASE WHEN ... THEN ... ... END<br>
    <tab></tab>KOL3 = (SELECT ... FROM ... WHERE)<br>
    <tab></tab>KOL4 = ... <br>
    WHERE ... 
</p>
<p class="kod">
    <b>UPDATE</b> NAZIV_TABELE <br>
    <b>SET</b> (KOL1, KOL2 ...) = (VREDNOST1, VREDNOST2, ...) <br>
    WHERE ... 
</p>

Ako ne navedemo WHERE izmeniće se svi redovi.

<h2>Brisanje redova iz baze</h2>
<p class="kod">
    <b>DELETE FROM</b> NAZIV_TABELE <br>
    WHERE ...
</p>
Ukoliko ne navedemo where biće obrisani svi redovi iz navedene tabele.

<div id="cas7zadaci"></div>
<script>
loadClassFromJSON("cas7zadaci", "resources/rbp/cas7.json")
</script>
<!-- CAS7 KRAJ-->

<!-- CAS8-->
<h1 id="cas8">ČAS 8</h1>
<h2>Pogled</h2>
<p class="kod">
    <b>CREATE VIEW</b> IME_POGLEDA <b>AS</b><br>
    SELECT ... <br>
    FROM ... <br>
    WHERE ...
</p>

<p class="kod"><b>DROP VIEW</b> IME_POGLEDA;</p>

<h2>Indeksi</h2>
<img src="./resources/rbp/index.gif" alt="index" style="width: 80%;">
<p class="kod">
    <b>CREATE INDEX</b> NAZIV_INDEKSA<br> 
    <b>ON</b> NAZIV_TABELE <br> 
    <tab></tab>(kol1 ASC, kol2 DESC, kol3...);
</p>

<p class="kod">
    <b>DROP INDEX</b> NAZIV_INDEKSA;
</p>

<h2>Korisnički definisane funkcije</h2>
<p class="kod">
    <b>CREATE FUNCTION</b> IME_FUNKCIJE (ARG1 ARG1_TIP, ARG2 ARG2_TIP...)<br>
    <b>RETURNS</b> TIP_POVRATNE_VREDNOSTI<br>
    <b>RETURN</b> IZRAZ_KOJI_RAČUNA_REZULTAT

</p>
<p class="kod"><b>DROP FUNCTION</b> IME_FUNKCIJE;</p>

<h2>Gde naći šta sve ima u bazi?</h2>
<p>Sve tabele se nalaze u tabeli SYSCAT.TABLES. Ako želimo samo tabele neke scheme možemo iskorisiti naredni upit:</p>
<p class="kod">
SELECT *<br>
FROM SYSCAT.TABLES<br>
WHERE TABSCHEMA = 'DA';
</p>

Sve poglede možemo naći u tabeli SYSCAT.VIEWS. Kolona OWNERTYPE može imati vrednosti S (system) i U (user), to možemo koristiti da lakše nađemo poglede koje smo mi kreirali.
<p class="kod">
SELECT *<br>
FROM SYSCAT.VIEWS <br>
WHERE OWNERTYPE = 'U';
</p>
<p>Indeksi se mogu naći u tabeli SYSCAT.INDEXES.</p>
<p class="kod">
    SELECT *<br>
    FROM SYSCAT.INDEXES <br>
    WHERE OWNERTYPE = 'U';
    </p>
<p>Sve funkcije se nalaze u tabeli SYSCAT.FUNCTIONS.</p>
<p class="kod">
    SELECT *<br>
    FROM SYSCAT.FUNCTIONS;
</p>

<div id="cas8zadaci"></div>
<script>
loadClassFromJSON("cas8zadaci", "resources/rbp/cas8.json")
</script>
<!-- CAS8 KRAJ-->

<!-- CAS9-->
<h1 id="cas9">ČAS 9</h1>
<h2>LISTAGG</h2>
<p>Listagg je agregatna funkcija koja spaja stringove iz grupe u jedan.</p>
<p class="kod">
    SELECT LISTAGG(STRING, SEPARATOR) WITHIN GROUP(ORDER BY ...)<br>
    FROM ... <br>
    GROUP BY ...; 
</p>
Withing group (order by) je opcioni argument.<br>
Ukupna dužina teksta ne može biti veća od 4000 karaktera.
STRING može biti neka kolona, kol1 || kol2, DISTINCT kol...

<h2>MERGE</h2>
<p class="kod">
    <b>MERGE INTO</b> IME_TABELE <br>
    <b>USING</b> (NEKI_UPIT) <br>
    <b>ON</b> USLOV_POKLAPANJA <br>
    <b>WHEN MATCHED THEN</b> <br>
    <tab></tab>... <br>
    <b>WHEN MATCHED AND ... THEN</b> <br>
    <tab></tab>... <br>
    <b>WHEN NOT MATCHED THEN</b><br>
    <tab></tab>... <br>
    <b>WHEN NOT MATCHED AND ... THEN</b><br>
    <tab></tab>... <br>

</p>

<h2>Okidači</h2>
<p class="kod">
    <b>CREATE TRIGGER</b> NAZIV_TRIGERA<br>
    <b>BEFORE/AFTER DELETE/UPDATE/CREATE</b><br>
    <b>ON</b> NAZIV_TABELE<br>
    <b>REFERENCING</b><br>
    <tab></tab> OLD AS STARI<br>
    <tab></tab> NEW AS NOVI<br>
    <b>FOR EACH ROW</b><br>
    <b>WHEN</b>(USLOV_KOJI_ISPUNJAVAJU_REDOVI_NA_KOJE_CE_SE_PRIMENITI_TRIGGER)<br>
    <b>BEGIN ATOMIC</b><br>
    <tab></tab>    ... ; <br>
    <tab></tab>    ... ; <br>
    <tab></tab>    ... ; <br>
    <b>END</b> @
</p>
<p>Kada radimo sa triggerima u većini slučajva ćemo imati više naredbi u telu i te naredbe treba razdvojiti sa ";". Ali ako ";" iskoistimo unutar kreiranja triggera (koji je jedna komanda), onda ne možemo to iskoristiti za kraj naredbe.
    Zbog toga uvodimo novi terminator, tipično @. 
</p>
<p class="kod">--#SET TERMINATOR @</p>
<p>Komanda ide baš ovako, -- u ovom slučaju ne gledaju ovo kao komentar. <br>
Ukoliko izvršavamo komande preko terminala koristimo narednu komandu:</p>
<p class="kod">db2 -td@ -f putanja_do_fajla</p>
<p>Ukoliko želimo da trigger javi grešku i zaustavi operaciju:</p>
<p class="kod">SIGNAL SQLSTATE '75000' ('Poruka o grešci koja će se ispisati korisniku.')</p>
<p>Sve triggere možemo videti u tabeli SYSCAT.TRIGGERS.</p>
<div id="cas9zadaci"></div>
<script>
loadClassFromJSON("cas9zadaci", "resources/rbp/cas9.json")
</script>
<!-- CAS9 KRAJ-->

    <h1 id="recap">SQL RECAP</h1>
    <img src="./resources/rbp/recap.png" alt="recap" style="width: 100%;">

<!-- CAS10 -->
<h1 id="cas10">ČAS 10</h1>
<h2>Relaciona algebra</h2>
<h3>Tabele sa kojima ćemo raditi:</h3>
<table id="relacione-tabele">
    <tr>
        <th>DOSIJE</th>
        <th>PREDMET</th>
        <th>ISPITNIROK</th>
        <th>ISPIT</th>
    </tr>
    <tr>
        <td>indeks<br>
            ime<br>
            prezime<br>
            mestorodjenja<br>
            datupisa</td>
        <td>idpredmeta<br>
            oznaka<br>
            naziv<br>
            espb</td>
        <td>
            skgodina<br>
            oznakaroka<br>
            naziv</td>
        <td>
            indeks<br>
            idpredmeta<br>
            skgodina<br>
            oznakaroka<br>
            ocena<br>
            datpolaganja<br>
            bodovi</td>
    </tr>
</table>

<h2>Osnovne operacije</h2>
<dl>
    <dt>Projekcija</dt>
    <dd>biramo atribute/kolone<br>
        kao SELECT <br>
        TABELA<b>[</b>kol1, kol2...<b>]</b>
    </dd>
    <dt>Restrikcija/Selekcija</dt>
    <dd>biramo redove koje želimo u rezultatu<br>
        kao WHERE <br>
        tabela <b>WHERE</b> ...
    </dd>
    <dt>Proizvod</dt>
    <dd>Dekartov proizvod - spaja svaki red jedne tabele sa svakim redom druge tabele<br>
        u SQL-u: from tab1,tab2<br>
        tab1 <b>TIMES</b> tab2
    </dd>
    <dt>Unija</dt>
    <dd> spajaju se redovi rezultata jednog upita sa redovima drugog upita<br>
        u SQL-u: UNION <br>
        upit1 <b>UNION</b>
    </dd>
    <dt>Presek</dt>
    <dd> zadržavaju se redovi koji se nalaze u rezultatima oba upita<br>
        u SQL-u: INTERSECT <br>
        upit1 <b>NTERSECT</b>
    </dd>
    <dt>Razlika</dt>
    <dd> zadržavaju se redovi koji se nalaze u rezultatima prvog upita, ali ne u rezultatu drugog upita<br>
        u SQL-u: MINUS, EXCEPT <br>
        upit1 <b>MINUS</b> upit2
    </dd>
    <dt>Slobodno spajanje</dt>
    <dd>restrikcija proizvoda dveju relacija<br>
        (tab1 TIMES tab2) WHERE A.x=B.y
    </dd>
    <dt>Prirodno spajanje</dt>
    <dd>spaja se po kolonama koje imaju isti NAZIV i OPSEG(TIP)<br>
        u SQL-u uz join ide ON uslov, dok ovde ne navodimo uslov, već se on podrazumeva<br>
        tab1 <b>JOIN</b> tab2</dd>
    <dt>Deljenje</dt>
    <dd>
        <ul>
            <li>Relacija A ima grupe kolona X i Y</li>
            <li>Relacija B ima grupu kolona Y</li>
            <li>Relacija B ima neke redove</li>
            <li>Delimo A sa B i u rezultatu dobijamo kolone X iz A takve da važi da je taj red u A uparen sa svim redovima iz B</li>
        </ul>
        Primeri:
        <img src="./resources/rbp/divide1.png" alt="divide" style="width: 100%;">
        <ol>
            <li> primer: U rezultatu se nalaze redovi koji su u A upareni sa p2 (iz B).</li>
            <li> primer: U A postoje redovi s1-p2 i s1-p4 pa s1 ide u rezultat. Postoje redovi s4-p2 i s4-p4 pa i s4 ide u rezultat. Da bi se s2 našao u rezultatu bilo bi porebno da postoje reodvi a2-p2(postoji) i s2-p4(ne postoji). Identično za s3.</li>
            <li> primer: Samo za vrednost s1 u A postoje parovi sa sve tri vrednost iz B, tj s1-p2, s1-p4 i s1-p1.</li>
        </ol>
    </dd>
</dl>

<h2>Izvršavanje koda</h2>
<p>Za primere urađene na vežbama i date za vežbu rezultat možete videti pomoću parsera za relacioni račun i relacionu algebru koleginice Ane Vulović u sintaksi koja se koristi na vežbama.
    Pomoću .deb paketa možete instalirati program na Ubuntu. Ovaj parser ne morate instalirati na virtuelnoj mašini za vežbe, već možete i na svom Linux sistemu.
    <br><br>
    <b>Na Ubuntu 20.04</b> - focal verzija<br>
    <i>sudo dpkg -i ./ime_preuzetog_fajla</i><br>
    ili sa<br>
    <i>sudo apt install ./ime_preuzetog_fajla</i><br><br>
    
    <b>Na Ubuntu 18.04 - 19.*</b> - bionic verzija<br>
    <i>sudo dpkg -i ./ime_preuzetog_fajla</i><br>
    ili sa<br>
    <i>sudo apt install ./ime_preuzetog_fajla</i> </p>
    <b>ime_preuzetog_fajle</b> bi treblo da bude <i>24-rarrchecker_1.0-1_amd64_bionic.deb</i> ili <i>24-rarrchecker_1.0-1_amd64_focal.deb</i>.<br><br>
    Možete probati da intalirate dvoklikom na preuzeti <i>.deb</i> fajl, tima ćete otvoriti Linux Software Installer. <br>
    <a href="./resources/rbp/24-rarrchecker_1.0-1_amd64_bionic.deb">rarrchecker_1.0-1_amd64_bionic.deb </a><br>
    <a href="./resources/rbp/24-rarrchecker_1.0-1_amd64_focal.deb">rarrchecker_1.0-1_amd64_focal.deb </a><br>

    <p>Kad instalirate parser možete ga naći među aplikacijama u meniju, ikonica je:</p>
    <img src="./resources/rbp/rarr.png" alt="rarr ikona"></img>

    <p>Ukoliko nemate odgovarajuće podatke u parseru možete ih učitate iz <a href="./resources/rbp/mala_studentska_baza.sql">datoteke</a>.
    U parseru idete menu > create database, zatim izaberete preuzetu datoteku. U datoteku možete dodati podatke ukoliko želite. </p>

<div id="cas10zadaci"></div>
<script>
loadClassFromJSON("cas10zadaci", "resources/rbp/cas10.json")
</script>
<!-- CAS10 KRAJ-->

<!-- CAS11-->
<h1 id="cas11">ČAS 11</h1>
<h2>Relacioni račun</h2>
<dl>
    <dt>Projekcija</dt>
    <dd>biramo atribute/kolone<br>
        range of red is relacija <br>
        red.A, red.B
    </dd>
    <dt>Restrikcija/Selekcija</dt>
    <dd>biramo redove koje želimo u rezultatu<br>
        range of red is relacija <br>
        red.X <br>
        <b>WHERE</b> ...
    </dd>
    <dt>Proizvod</dt>
    <dd>Dekartov proizvod - spaja svaki red jedne tabele sa svakim redom druge tabele<br>
        range of px is predmet <br>
        range of ix is ispit
    </dd>
    <dt>exists x (uslov)</dt>
    <dd>Navedeni uslov mora da važi za bar jednu n-torku x. Domen relacije x je samo uslov, ne možemo ga koristiti van zagrada uslova.</dd>
    <dt>forall x (uslov)</dt>
    <dd>Navedeni uslov mora da važi za sve n-torke iz x.  Domen relacije x je samo uslov, ne možemo ga koristiti van zagrada uslova.<br>
        forall x (uslov)  <=> not exists x (not uslov)
    </dd>
    <dt>Implikacija</dt>
    <dd>if form1 then form2 <br>
        if a then b <=> not p or q 
    </dd>
</dl>
<p>Ako radimo nad dve tabele, na primer predmet i ispit. U rezultatu možemo izdvojiti samo kolone iz na primer predmeta, ali onda kolone iz ispita ne možemo imati u where. Da bi u ovom slučaju gli da koristimo kolone iz where potrebno je da ispisujemo bar jednu kolonu iz tabele ispit (ne nužno onu koju koristimo) ili da koristimo exists/forall.</p>
<ul>
    <li>exists x exists y (...) <=> exists y exists x (...)</li>
    <li>forall x forall y (...) <=> forall y forall x (...)</li>
    <li>forall x exists y (...) <=/=> exists y forall x (...)</li>
    <li>forall(if p then q) <=> <br>
        forall (not p or q) <=> <br>
        not exists (not (not p or q)) <=> <br>
        not exists (p and not q)</li>
</ul>
<div id="cas11zadaci"></div>
<script>
loadClassFromJSON("cas11zadaci", "resources/rbp/cas11.json")
</script>
<!-- CAS11 KRAJ-->

<!-- levi div-->
         </div>

    </main>

</body>
</html>
